---
import i18n, { t, changeLanguage } from "i18next";
import Layout from "../../layouts/Layout.astro";
import Block from "../../components/table/Block.astro";
import ButtonWithImage from "../../components/table/ButtonWithImage.astro";
import getLocaledURL from "../../utils/localedURL.ts";
import { Prepr } from "src/utils/prepr";
import GetProjects from "src/queries/get-projects";

changeLanguage("uk");

const response = await Prepr(GetProjects(i18n.language));
const { data } = await response.json();
const projects = data.Projects.items;
---

<Layout title={t('projects.title')} description={t('projects.description')}>
  <h1 class='hidden'>{`${t('prjects')} | ${t('common:title.short')}`}</h1>
  <section class='relative h-[100vh] min-h-[100vh] w-full overflow-x-hidden'>
    <div
      class='absolute left-0 top-0 grid h-full w-[100vw] grid-cols-2 md:grid-cols-6 lg:grid-cols-8'
    >
      <Block s='md' />
      <ButtonWithImage
        path={getLocaledURL('/')}
        alt={t('title')}
        title={t('title')}
        src='/svgs/logo-ua.svg'
      />
      {
        projects.map((e: any) => (
          <a
            class='group relative col-span-2 row-span-2 aspect-square overflow-hidden'
            href={getLocaledURL(`/projects/${e._slug}`)}
          >
            <div class='absolute inset-0 flex flex-col object-cover duration-300'>
              <img
                src={e.images ? e.images[0].url : 'https://placehold.co/400'}
                alt={e.title}
                class='opacity-100 duration-300 group-hover:scale-110 group-hover:opacity-75'
                width='640'
                height='640'
              />
              <div class='absolute inset-x-0 bottom-0 rounded-t-md bg-white px-2 py-3 text-3xl font-semibold'>
                {e.title}
              </div>
            </div>
          </a>
        ))
      }
    </div>
  </section>
</Layout>
